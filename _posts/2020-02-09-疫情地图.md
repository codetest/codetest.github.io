# 疫情地图的实现
## 起源
最近这段时间大家都在关注着新型肺炎的情况。很多人能够做的就是不要随便出门，戴口罩等避免疫情扩散。程序员更多地是从提高生产和信息效率的角度进行帮助。比如UC就有一个疫情相关的专题，通过分享得到[页面URL](https://iflow.uc.cn/webview/article/newspecial.html?uc_biz_str=S%3Acustom%7CC%3Atitlebar_hover_2&aid=3804775841868884355&cid=100&uc_param_str=lodndseiwifrvesvntgi&sm_article_id=3804775841868884355&uc_h5_page_name=iflowspecial&feiyan=1&feiyan_jump=-3&app=uc-iflow&enterfrom=xxl-bigboycard&zzd_from=uc-iflow&dl_type=2&recoid=6522731290214947756&activity=1&activity2=1&from=singlemessage)。截图如下
![疫情地图](/images/%E7%96%AB%E6%83%85%E5%9C%B0%E5%9B%BE/Example.jpg)

通过颜色深浅直观地显示疫情的严重情况，点击其中的省市能够显示出对应的疫情数据，这是不错的交互和信息获取的方式。在这里面如果简单想一下，除了渲染以外有2个重要的数据，1）地图数据，2）疫情数据。因此我们简单地查看一下UC的页面都有什么东西。

## 调试
我们先看一下页面上加载了什么脚本。
![页面脚本](/images/%E7%96%AB%E6%83%85%E5%9C%B0%E5%9B%BE/Debug1.png)
这几个脚本的名字明显都没有某些开源库的痕迹，应该是UC内部开发的一些地图组件或者说是重新打包过的，不好分析。再来看一下数据，第一个是第一次请求html里面的内容。
![页面内容](/images/%E7%96%AB%E6%83%85%E5%9C%B0%E5%9B%BE/Debug2.png)
从这个页面里面没有找到疫情的具体数值，因此数据可能通过页面加载完毕之后的请求加载的，如果是通过脚本加载不大现实，这意味着要每次都更新脚本部署，实现起来会比较麻烦的。
那么我们在来查看一下XHR里面有什么数据。果然看到了疫情相关的数据([Link](https://iflow-api.uc.cn/feiyan/list?trend=1&iflow=1&district=1&uc_param_str=pccplo))
![XHR内容](/images/%E7%96%AB%E6%83%85%E5%9C%B0%E5%9B%BE/Debug3.png)
那么我们缺少的是地图数据和地图显示交互组件了。

## echarts
通过搜索"地图 H5"，得到的大部分结果都是使用echarts。我们就到官网看到相关的地图[例子](https://www.echartsjs.com/examples/en/index.html#chart-type-map)。可以看到香港的那个例子比较接近的。
![map](/images/%E7%96%AB%E6%83%85%E5%9C%B0%E5%9B%BE/echarts.png)
