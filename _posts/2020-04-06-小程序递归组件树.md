# 小程序递归组件树
## 缘由
在阅读[小程序框架运行时性能大测评](https://segmentfault.com/a/1190000022249399)的时候，自己也照着写监控setData事件。当中发生小插曲，就是按照原文的方法在小程序1.9.4是运行抛错误的，原因是setData是readonly，于是改用defineProperty的方式监控setData。另外自己也习惯使用typescript，调试运行花了些时间。在调试到kbone的时候，发现传递的数据是特别大的，而且是虚拟节点数据。再经过研究之后发现，kbone的页面渲染是由组件的递归定义实现的，对应的data也需要一一对应来描述节点树。因此我也想找着写一个原始版的递归组件页面。

## 递归组件
为了简单处理，原始组件只以span和image为例。因此得到了下面的数据结构定义。
```typescript
export interface View{
  nodes: Node[];
  id: string;
}

export interface Node{
  type: number;
  src?: string;
  text?: string;
  view?: View;
  id: string;
}
```
